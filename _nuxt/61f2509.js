(window.webpackJsonp=window.webpackJsonp||[]).push([[7,2,3],{255:function(e,t,n){"use strict";n.r(t);var r=n(45),component=Object(r.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nuxt-link",{staticClass:"button is-info",attrs:{to:"./new"}},[n("b-icon",{attrs:{icon:"ballot"}}),e._v(" "),n("strong",[e._v("Create a poll")])],1)}),[],!1,null,null,null);t.default=component.exports},256:function(e,t,n){e.exports=n.p+"img/navbar-logo.6f28513.png"},257:function(e,t,n){"use strict";n.r(t);var r={props:{current:{type:String,required:!0}}},o=n(45),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-navbar",{scopedSlots:e._u([{key:"brand",fn:function(){return[r("nuxt-link",{staticClass:"navbar-item",attrs:{to:"./"}},[r("img",{attrs:{src:n(256)}})])]},proxy:!0},{key:"start",fn:function(){return[r("b-navbar-item",{attrs:{tag:"nuxt-link",to:"./"}},[r("span",{class:"/"===e.current?"has-text-primary":""},[e._v("\n                Home\n            ")])]),e._v(" "),r("b-navbar-item",{attrs:{tag:"nuxt-link",to:"./new"}},[r("span",{class:"/new"===e.current?"has-text-primary":""},[e._v("\n                Create\n            ")])]),e._v(" "),r("b-navbar-item",{attrs:{tag:"nuxt-link",to:"./about"}},[r("span",{class:"/about"===e.current?"has-text-primary":""},[e._v("\n                About\n            ")])])]},proxy:!0},{key:"end",fn:function(){return[r("b-navbar-item",{staticClass:"buttons"},[r("PollCreateButton")],1)]},proxy:!0}])})}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{PollCreateButton:n(255).default})},262:function(e,t,n){"use strict";n.r(t);var r=n(9),o=(n(58),n(74),n(29),n(31),n(46),n(2)),l=n(258),c=n.n(l),d=o.a.extend({name:"IndexPage",components:{draggable:c.a},data:function(){return{name:"",description:"",candidates:[],creationTime:new Date(0),endTime:new Date(0),numWinners:0,isIPOnly:!1,numVotes:0,ended:!1,winners:void 0,isLoading:!0,drag:!1,exists:!1}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$route.params.id,t.prev=1,t.next=4,e.$axios.$get("".concat(e.$config.API_URL,"/poll/").concat(n));case 4:if((data=t.sent).success){t.next=11;break}if(data.error){t.next=8;break}throw new Error("no error from server");case 8:return e.$buefy.toast.open({duration:5e3,message:data.error,type:"is-danger"}),e.isLoading=!1,t.abrupt("return");case 11:e.name=data.name,window.document.title="".concat(data.name," | ").concat(window.document.title),e.description=data.description,e.candidates=data.candidates,e.creationTime=new Date(1e3*data.creationTime),e.endTime=new Date(1e3*data.endingTime),e.numWinners=data.numWinners,e.winners=data.winners,e.isIPOnly="ip"===data.protection,e.numVotes=data.numVotes,e.ended=data.ended,e.exists=!0,e.isLoading=!1,t.next=30;break;case 26:t.prev=26,t.t0=t.catch(1),e.$buefy.toast.open({duration:5e3,message:"There was an error connecting to the server",type:"is-danger"}),console.error("An error occurred GETing /poll/".concat(n,": ").concat(t.t0," ").concat(JSON.stringify(t.t0)));case 30:case"end":return t.stop()}}),t,null,[[1,26]])})))()},methods:{submit:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$route.params.id,e.candidates.length||(e.$buefy.toast.open({duration:5e3,message:"You must select at least one candidate!",type:"is-danger"}),e.$router.push("/poll/".concat(n))),e.isLoading=!0,t.prev=3,t.next=6,e.$axios.$post("".concat(e.$config.API_URL,"/poll/").concat(n,"/vote"),{choices:e.candidates});case 6:(data=t.sent).success?(e.isLoading=!1,e.$buefy.toast.open({duration:5e3,message:"You have voted successfully!",type:"is-success"}),e.$forceUpdate()):(e.isLoading=!1,e.$buefy.toast.open({duration:5e3,message:data.error||"There was an error voting in the poll",type:"is-danger"})),t.next=15;break;case 10:t.prev=10,t.t0=t.catch(3),e.isLoading=!1,e.$buefy.toast.open({duration:5e3,message:"An error occured contacting our servers; make sure you are connected to the Internet",type:"is-danger"}),console.error("An error occurred while POSTing to /poll/".concat(n,"/vote: ").concat(t.t0," ").concat(JSON.stringify(t.t0)));case 15:case"end":return t.stop()}}),t,null,[[3,10]])})))()}}}),v=n(45),component=Object(v.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",[n("NavigationMenu",{attrs:{current:"none"}}),e._v(" "),n("b-loading",{model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}}),e._v(" "),n("section",{staticClass:"section"},[n("h1",{staticClass:"title"},[e._v("\n        Poll: "+e._s(e.name)+"\n      ")]),e._v(" "),n("div",{staticClass:"container notification"},[e._v("\n        "+e._s(e.description)+"\n      ")]),e._v(" "),e.ended?n("div",{attrs:{id:"expired-poll"}},[n("b-message",{attrs:{type:"is-info","aria-close-label":"Close message"}},[n("strong",[e._v("This poll has ended.")]),e._v(" "),n("br"),e._v("\n          This poll was created on\n          "+e._s(e.creationTime.toLocaleString(void 0,{dateStyle:"full",timeStyle:"short"}))+"\n          and ended on "+e._s(e.endTime.toLocaleString(void 0,{dateStyle:"full",timeStyle:"short"}))+".\n          "),n("br"),e._v("\n          "+e._s(e.numVotes)+" vote"+e._s(1===e.numVotes?"":"s")+" were cast in this poll.\n        ")]),e._v(" "),0===e.winners.length?n("div",{attrs:{id:"no-winners"}},[e._v("\n          There were no winners.\n        ")]):n("div",[n("h2",{staticClass:"title",attrs:{id:"winners-heading"}},[e._v("\n            Winner"+e._s(e.winners.length>1?"s":"")+": "),e._l(e.winners,(function(t,r){return n("span",{key:t},[n("b",[e._v(e._s(t))]),e._v(e._s(r===e.winners.length-1||2===e.winners.length?"":", ")+e._s(r===e.winners.length-2?" and ":"")+"\n            ")])}))],2)])],1):n("div",{attrs:{id:"ongoing-poll"}},[e.exists?n("b-message",{attrs:{type:"is-info","aria-close-label":"Close message"}},[e._v("\n          This poll was created on\n          "+e._s(e.creationTime.toLocaleString(void 0,{dateStyle:"full",timeStyle:"short"}))+";\n          it will end on "+e._s(e.endTime.toLocaleString(void 0,{dateStyle:"full",timeStyle:"short"}))+".\n          "),n("br"),e._v("\n          This poll will ultimately have "),n("strong",[e._v(e._s(e.numWinners))]),e._v("\n          winner"+e._s(1===e.numWinners?"":"s")+".\n          "),n("br"),e._v("\n          "+e._s(e.numVotes)+" vote"+e._s(1===e.numVotes?" has":"s have")+" been cast in this poll so far.\n          "),n("br"),e._v(" "),e.isIPOnly?n("strong",[e._v("\n            Your IP address will be recorded when you vote in this poll; it will be used to prevent double voting.\n          ")]):e._e()]):n("b-message",{attrs:{type:"is-info"}},[e._v("\n          This poll does not exist.\n        ")]),e._v(" "),e.exists?n("h2",{staticClass:"title title-small"},[e._v("\n          Rank your choices\n          "),n("b-tooltip",{attrs:{multilined:"",type:"is-primary",label:"\n              Drag and drop the choices into your preferred order.\n              If you don't want to vote for a choice at all, click the red button to remove it.\n            "}},[n("b-icon",{attrs:{icon:"help-circle-outline"}})],1)],1):e._e(),e._v(" "),n("div",{staticClass:"flex"},[n("table",{staticClass:"table is-hoverable"},[e._m(0),e._v(" "),e._l(e.candidates,(function(t,r){return n("tr",{key:r},[n("td",[e._v("#"+e._s(r+1))])])}))],2),e._v(" "),n("table",{staticClass:"table is-hoverable is-fullwidth"},[e._m(1),e._v(" "),n("draggable",{attrs:{group:"people",tag:"tbody"},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}},model:{value:e.candidates,callback:function(t){e.candidates=t},expression:"candidates"}},e._l(e.candidates,(function(t){return n("tr",{key:t},[n("td",[e._v(e._s(t))]),e._v(" "),n("td",[n("b-button",{staticClass:"is-danger",attrs:{id:"small-button","icon-left":"delete"},on:{click:function(n){e.candidates=e.candidates.filter((function(e){return e!==t}))}}})],1)])})),0)],1)]),e._v(" "),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-link",on:{click:e.submit}},[e._v("\n              Vote\n          ")])])],1)])],1)}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",{attrs:{scope:"col"}},[e._v("\n                  Rank\n                ")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",{attrs:{scope:"col"}},[e._v("\n                  Choice\n                ")]),e._v(" "),n("th")])])}],!1,null,null,null);t.default=component.exports;installComponents(component,{NavigationMenu:n(257).default})}}]);